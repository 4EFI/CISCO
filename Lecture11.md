# NAT (Network Address Translation) / PAT (Port Address Translation)

С увеличением числа подключённых устройств возникает проблема нехватки IPv4-адресов. NAT и PAT предлагают решения для эффективного управления ограниченными адресными ресурсами.

## NAT (Network Address Translation)

NAT позволяет подменять адреса в пакетах (вмешивается в сетевой адрес), проходящих через маршрутизатор или другой сетевой узел. Это обеспечивает нескольким устройствам в частной сети доступ к Интернету через один публичный IP-адрес.

Рассмотрим следующую схему: 

<p style="text-align: left"><img src=res/11_1.png width="600px"/></p>

Администратор случайно удалил Default Gateway на узле B. Данные от узла A до узла B дойдут, НО проблема обратной отправки. Эту проблему можно решить настройкой NAT на R1: 

<p style="text-align: left"><img src=res/11_2.png width="600px"/></p>

### Динамическое выделение адресов с помощью NAT

Динамическое выделение адресов через NAT (Network Address Translation) позволяет эффективно использовать ограниченный пул публичных IP-адресов для множества устройств в частной сети.

#### Как это работает:
- Пул адресов: Установлен пул публичных IP-адресов, доступных для назначения.
- Назначение по запросу: При запросе устройства в сеть, NAT временно предоставляет один из доступных публичных адресов из пула.
- Возврат в пул: После завершения сеанса подключения, использованный адрес возвращается в пул и может быть вновь назначен другому устройству.

<p style="text-align: left"><img src=res/11_3.png width="500px"/></p>

## PAT (Port Address Translation)

Выделение ТОЛЬКО одного адреса. Вмешивается в Транспортный уровень.

<p style="text-align: left"><img src=res/11_4.png width="500px"/></p>

<p style="text-align: left"><img src=res/11_5.png width="700px"/></p>
<p style="text-align: left"><img src=res/11_6.png width="500px"/></p>

Выше приведен пример динамический режим PAT. PAT также имеет возможность статических записей.


## FTP (File Transfer Protocol)

FTP — это способ передавать файлы через интернет между твоим компьютером и сервером. Как взять и положить что-то на чужой большой компьютер.

### Активный режим

- Как это работает: Ты подключаешься к серверу и говоришь ему, что хочешь отправить или получить файлы.
- Минус: Сервер сам стучится к тебе, что иногда блокируется защитой твоего интернета (вроде фаерволов или NAT).

### Пассивный режим

- Как это работает: Ты полностью контролируешь процесс и говоришь серверу, чтобы он ждал твоих подключений.
- Плюс: Это более безопасно и работает даже с сильной интернет-защитой.

### Application Layer Gateway (ALG)

- Это специальная программа на роутерах, которая помогает легко передавать сложные данные.
- Зачем нужно? ALG автоматически решает проблемы соединений, которые NAT может блокировать.
